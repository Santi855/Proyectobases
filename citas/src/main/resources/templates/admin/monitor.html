<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Monitor de Actividad - HospiCitas Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #f0f2f5; min-height: 100vh; display: flex; flex-direction: column; }
        .main-content { flex: 1; padding: 30px 0; }
        
        /* Estilo de la Bitácora */
        .log-container { background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); overflow: hidden; }
        .log-header { background: #212529; color: white; padding: 20px; }
        
        /* Colores por tipo de acción */
        .action-badge { border-radius: 50px; padding: 5px 15px; font-weight: bold; font-size: 0.7rem; }
        .bg-desactivar { background-color: #ffe5e5; color: #d90429; border: 1px solid #ffb3b3; }
        .bg-activar { background-color: #e5f9e0; color: #2d6a4f; border: 1px solid #b7e4c7; }
        .bg-crear { background-color: #e0f2fe; color: #0369a1; border: 1px solid #bae6fd; }
        .bg-editar { background-color: #fef3c7; color: #92400e; border: 1px solid #fde68a; }

        .time-text { font-size: 0.85rem; color: #6c757d; }
        .user-tag { background: #f8f9fa; border-radius: 6px; padding: 2px 8px; font-family: monospace; font-weight: bold; border: 1px solid #dee2e6; }
        
        footer { background: #212529; color: #adb5bd; padding: 30px 0; margin-top: 50px; }
    </style>
</head>
<body>

<nav class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold" th:href="@{/admin/home}">
            <i class="fas fa-terminal me-2 text-info"></i> Monitor de Sistema
        </a>
        <a th:href="@{/admin/home}" class="btn btn-outline-light btn-sm">Regresar al Panel</a>
    </div>
</nav>

<div class="container main-content">
    <div class="row mb-4">
        <div class="col-md-8">
            <h2 class="fw-bold"><i class="fas fa-history me-2 text-primary"></i>Bitácora de Auditoría</h2>
            <p class="text-muted">Registro en tiempo real de todos los movimientos administrativos.</p>
        </div>
        <div class="col-md-4 text-md-end">
            <button onclick="window.location.reload()" class="btn btn-white shadow-sm border">
                <i class="fas fa-sync-alt me-1"></i> Actualizar
            </button>
        </div>
    </div>

    <div class="log-container">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light">
                    <tr>
                        <th class="ps-4">Fecha y Hora</th>
                        <th>Usuario</th>
                        <th>Acción</th>
                        <th>Detalles del Movimiento</th>
                        <th class="text-end pe-4">ID Log</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="log : ${logs}">
                        <td class="ps-4">
                            <div class="d-flex flex-column">
                                <span class="fw-bold" th:text="${#temporals.format(log.fechaHora, 'dd/MM/yyyy')}"></span>
                                <span class="time-text" th:text="${#temporals.format(log.fechaHora, 'HH:mm:ss')}"></span>
                            </div>
                        </td>
                        <td>
                            <span class="user-tag"><i class="fas fa-user-circle me-1"></i>[[${log.usuarioResponsable}]]</span>
                        </td>
                        <td>
                            <span class="action-badge" 
                                  th:classappend="${log.accion == 'DESACTIVAR' ? 'bg-desactivar' : 
                                                  (log.accion == 'ACTIVAR' ? 'bg-activar' : 
                                                  (log.accion == 'CREAR' ? 'bg-crear' : 'bg-editar'))}"
                                  th:text="${log.accion}">
                            </span>
                        </td>
                        <td class="small text-muted" th:text="${log.detalles}"></td>
                        <td class="text-end pe-4 text-muted small" th:text="'#' + ${log.idLog}"></td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(logs)}">
                        <td colspan="5" class="text-center py-5">
                            <i class="fas fa-inbox fa-3x text-light mb-3 d-block"></i>
                            <span class="text-muted">No hay registros de actividad todavía.</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<footer>
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-6 text-center text-md-start">
                <h6 class="text-white fw-bold mb-0">HospiCitas Pro <span class="text-info">Audit</span></h6>
                <small>Sistema de Trazabilidad Hospitalaria v2.0</small>
            </div>
            <div class="col-md-6 text-center text-md-end">
                <small><i class="fas fa-shield-alt text-success me-1"></i> Los registros de auditoría no pueden ser eliminados.</small>
            </div>
        </div>
    </div>
</footer>

</body>
</html>